---
import { getArticleLink, getFormattedDate } from "@helpers/article";
import { Icon } from "astro-icon/components";
import type { CollectionEntry } from "astro:content";
import { articleCardWidth } from "const";
import { BlogType } from "content/config";
import MiddleDot from "./middle-dot.astro";

interface Props {
    article: CollectionEntry<"blog">;
}

const { article } = Astro.props;
const { title, publicationDate, category, editDate } = article.data;
const formattedPubTime = getFormattedDate(publicationDate);
const formattedEditDate = getFormattedDate(editDate, true);
const isHome = Astro.url.pathname === "/";
---

<a href={getArticleLink(article.slug)}>
    <article class=`group py-4 ${articleCardWidth}`>
        <h2 class="text-balance text-xl font-semibold leading-tight tracking-tight">
            {title}
        </h2>
        <section class="flex items-center gap-3 font-serif text-sm sm:text-base">
            <time class="text-font-color-muted" datetime={publicationDate.toDateString()}
                >{formattedPubTime}</time
            >
            {
                editDate && formattedEditDate && (
                    <>
                        <MiddleDot />
                        <time class="text-font-color-muted" datetime={editDate.toDateString()}>
                            Update {formattedEditDate}
                        </time>
                    </>
                )
            }
            {
                isHome && (
                    <>
                        <MiddleDot />
                        <span class:list={[category === BlogType.dev ? "text-dev" : "text-beyond"]}>
                            {category === BlogType.dev ? "dev" : "beyond"}
                        </span>
                    </>
                )
            }
        </section>
        <p
            class="flex items-center gap-1 font-serif text-sm text-font-color-muted opacity-0 transition duration-500 ease-in group-hover:opacity-100"
        >
            Read more<Icon name="arrow-right" />
        </p>
    </article>
</a>
