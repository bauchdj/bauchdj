---
import ArticleHeader from "@components/article-header.astro";
import { getAllPublishedArticles, getArticle } from "@data/articles";
import ArticleLayout from "@layouts/article-layout.astro";
import PageLayout from "@layouts/page-layout.astro";
import SeoArticle from "@layouts/seo-article.astro";
import { CONFIG, PATHS } from "const";

export async function getStaticPaths() {
    const allArticles = await getAllPublishedArticles();
    return allArticles.map((article) => {
        return {
            params: { articleSlug: article.data.slug },
        };
    });
}

const article = await getArticle(Astro.params.articleSlug);
if (!article) {
    return {
        status: 404,
    };
}

const { Content } = await article.render();
---

<PageLayout>
    <SeoArticle slot="head" />
    <ArticleLayout>
        <ArticleHeader article={article} />
        <Content />
    </ArticleLayout>
    <hr class="mb-8 h-px border-0 bg-gray-200 dark:bg-gray-700" />
    <div class="flex flex-row justify-between">
        <a href={PATHS.home}>${CONFIG.author} &middot; {new Date().getFullYear()}</a>
        <a
            target="_blank"
            rel="noopener noreferrer"
            href=`http://twitter.com/share?text=${article.data.title}&url=${Astro.request.url}`
        >
            Share on ùïè
        </a>
    </div>
</PageLayout>
